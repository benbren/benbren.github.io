<p>layout: post
title:  “Least Squares via the SVD”
date:   2018-04-11 20:00:00 -0700
categories: jekyll update</p>

<hr />

<script type="text/javascript" async="" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<p>Let’s say you have some matrix of features (covariates) <script type="math/tex">A \in \mathbb{R}^{m \times n}</script> and a response vector <script type="math/tex">y \in \mathbb{R}^m</script>. We want to find the input vector <script type="math/tex">x \in \mathbb{R}^n</script> that solves this problem or gives us the best possible solution. How should we define best? That is subjective - but the most common idea is to take the real response <script type="math/tex">y_i</script> and the predicted response $latex A[i,:] x$ and square the difference for each response. We can formalize this problem as</p>

<script type="math/tex; mode=display">argmin_x|| Ax - y ||_2^2</script>

<table>
  <tbody>
    <tr>
      <td>where $$</td>
      <td> </td>
      <td>.</td>
      <td> </td>
      <td>_2 <script type="math/tex">is the</script> \ell_2$$ norm - where we are just summing the components squared of the input to the norm (in this case, summing predicted minus real squared: the squared error) and taking the square root. We square it just to get rid of the square root - it is the same problem!</td>
    </tr>
  </tbody>
</table>

<p>Sometimes there may not an exact solution to this problem - that’s why all we are trying to do is minimize this sum of squares. Obviously, if there is an exact solution, that is going to minimize the squared error because, well, there is no error in that case!</p>

<p>When would there be no error? Clearly, this must be the case that <script type="math/tex">y \in \mathcal{R}(A)</script> for there to be no error. That is, the rank of <script type="math/tex">A</script> must be <script type="math/tex">m</script> for there to be no error. Does this guarantee the solution is unique? No. For the solution to be unique, <script type="math/tex">\mathcal{N}(A)</script> must be <script type="math/tex">\phi</script>. That is, the rank of <script type="math/tex">A</script> must be <script type="math/tex">n</script>. Thus, for there to be a unique solution with zero error, <script type="math/tex">A</script> must be square. Notice that a unique solution and a solution with zero error are different concepts. You can have a unique solution where the error is non-zero, and you can have lots (infinite, actually!) solutions that are exact. So, now that we have some intuition into the problem, let’s work on solving it. Let’s think about it geometrically! Let’s consider the 3 <script type="math/tex">\times</script> 3 matrix</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{bmatrix}  1 & 0 & 0 \\  0 & 1 & 0 \\ 0 & 0 & 0 \\ \end{bmatrix} %]]></script>

<p>The range of this matrix is the x-y plane, obviously, since its columns span <script type="math/tex">\mathbb{R}^2</script>. So what if we want to solve a problem of the form</p>

<script type="math/tex; mode=display">argmin_x|| Ax - b ||_2^2</script>

<p>where <script type="math/tex">b \in \mathbb{R}^3</script> and is non-zero in the z-component that is closest to the vector <script type="math/tex">b</script> that exists in the range of our transformation. Check out this figure.</p>

<p><img src="/assets/pics/projection_svd.jpg" alt="Projection" /></p>
